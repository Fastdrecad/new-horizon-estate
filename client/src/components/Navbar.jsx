import { useEffect, useState } from "react";
import { FaSearch } from "react-icons/fa";
import { useSelector } from "react-redux";
import { Link, useNavigate } from "react-router-dom";

export default function Navbar() {
  const { currentUser } = useSelector((state) => state.user);
  const [searchTerm, setSearchTerm] = useState("");
  const navigate = useNavigate();

  const handleSubmit = (e) => {
    e.preventDefault();
    const urlParams = new URLSearchParams(window.location.search);
    urlParams.set("searchTerm", searchTerm);
    const searchQuery = urlParams.toString();
    navigate(`/search?${searchQuery}`);
  };

  useEffect(() => {
    const urlParams = new URLSearchParams(window.location.search);
    const searchTermFromUrl = urlParams.get("searchTerm");
    if (searchTermFromUrl) {
      setSearchTerm(searchTermFromUrl);
    }
  }, []);

  return (
    <header className="bg-slate-200 shadow-3xl">
      <div className="flex items-center max-w-6xl mx-auto p-5 gap-4">
        <Link to="/" className="flex-shrink-0">
          <svg
            viewBox="0 0 420 177.1"
            className="w-16 sm:w-24 md:w-32 lg:w-40 xl:w-48"
            fill="#334155"
          >
            <g>
              <g>
                <path
                  d="M37.8,171.9c2.3,0,3.4-1.5,3.4-3.2c0-1.6-1.2-3.3-3.5-3.3h-4.6V176h0.8v-4h2.9l3.6,4h1.1L37.8,171.9z
						M33.9,166.2h3.8c1.7,0,2.6,1.3,2.6,2.5c0,1.5-0.8,2.5-2.7,2.5h-3.7L33.9,166.2z"
                />
                <path d="M55,166.2h6.5v-0.8h-7.3V176h7.4v-0.8H55V171h6.2v-0.7H55L55,166.2z" />
                <path d="M84.2,176l-4.7-10.5h-0.9L73.9,176h0.9l1.1-2.6h6.3l1.2,2.6L84.2,176z M76.2,172.6l2.8-6.4l2.8,6.4H76.2z" />
                <path d="M97.5,165.4V176h6.7v-0.8h-5.9v-9.7L97.5,165.4z" />
                <path d="M129.6,166.2h6.5v-0.8h-7.3V176h7.4v-0.8h-6.6V171h6.2v-0.7h-6.2L129.6,166.2z" />
                <path
                  d="M157.2,167.1c-1-1.5-2.3-1.8-3.8-1.8c-1.7,0-4,0.7-4,2.9c0,1.9,2,2.3,3.9,2.7c1.7,0.3,3.5,0.7,3.5,2.3
					c0,1.9-2.1,2.2-3.4,2.2c-1.3,0-2.9-0.6-3.6-1.9l-0.7,0.4c0.8,1.6,2.7,2.3,4.3,2.3c1.8,0,4.1-0.6,4.2-2.9c0-2.3-2.1-2.6-4.1-3
					c-1.8-0.3-3.2-0.6-3.2-2c0-1.7,2-2.1,3.2-2.1c1.2,0,2.4,0.2,3.2,1.4L157.2,167.1z"
                />
                <path d="M173.7,176h0.8v-9.8h3.8v-0.7h-8.4v0.7h3.8L173.7,176z" />
                <path
                  d="M200.8,176l-4.7-10.5h-0.9l-4.7,10.5h0.9l1.1-2.6h6.3l1.2,2.6L200.8,176z M192.8,172.6l2.8-6.4l2.8,6.4H192.8
					z"
                />
                <path d="M216.6,176h0.8v-9.8h3.8v-0.7h-8.4v0.7h3.8L216.6,176z" />
                <path d="M235,166.2h6.5v-0.8h-7.3V176h7.4v-0.8H235V171h6.2v-0.7H235V166.2z" />
                <path d="M276.3,176l-4.7-10.5h-0.9L266,176h0.9l1.1-2.6h6.3l1.2,2.6L276.3,176z M268.3,172.6l2.8-6.4l2.8,6.4H268.3z" />
                <path
                  d="M298.4,166.9c-1-1-2.4-1.6-3.8-1.6c-3.2,0-5.4,2.1-5.4,5.4c0,2.9,1.8,5.4,5.4,5.4c1.6,0,2.9-0.6,4-1.7v-3.9
					h-4.4v0.7h3.7v2.9c-0.9,0.8-2.1,1.2-3.2,1.2c-3.1,0-4.6-2.1-4.6-4.6c0-2.4,1.6-4.7,4.6-4.7c1.2,0,2.5,0.5,3.4,1.4L298.4,166.9z"
                />
                <path d="M313.8,166.2h6.5v-0.8H313V176h7.4v-0.8h-6.6V171h6.2v-0.7h-6.2L313.8,166.2z" />
                <path d="M334.3,165.4V176h0.8v-8.7l7.1,8.7h0.3v-10.5h-0.8v8.7l-7.1-8.7H334.3z" />
                <path
                  d="M365.2,174c-0.9,0.9-2.1,1.3-3.3,1.3c-3,0-4.6-2.1-4.6-4.6c0-2.5,1.6-4.7,4.6-4.7c1.2,0,2.4,0.5,3.3,1.3
					l0.6-0.5c-1-1-2.4-1.6-3.8-1.6c-3.6,0-5.4,2.6-5.4,5.4c0,2.8,1.9,5.3,5.4,5.3c1.4,0,2.8-0.6,3.8-1.6L365.2,174z"
                />
                <path d="M382,176h0.8v-4.2l4.1-6.3v0H386l-3.6,5.5l-3.6-5.5h-0.9v0l4.1,6.3L382,176z" />
              </g>
              <g>
                <path
                  d="M0,116.8v37.6h4.6c1.3,0,2.3-0.5,3.2-1.4c0.9-0.9,1.3-2,1.3-3.3v-20.9c0-0.1,0-0.3,0.1-0.4
					c0.1-0.1,0.2-0.2,0.4-0.2c0.1,0,0.3,0,0.4,0.1c0.1,0.1,0.2,0.2,0.2,0.4l5.4,22.1c0.7,2.2,2.1,3.4,4.4,3.6c2.4,0,4.8,0,7.2,0h0.2
					v-37.6h-4.6c-1.3,0-2.3,0.5-3.2,1.4c-0.9,0.9-1.3,2-1.3,3.3v20.9c0,0.1,0,0.3-0.1,0.4c-0.1,0.1-0.2,0.2-0.4,0.2
					c-0.1,0-0.3,0-0.4-0.1c-0.1-0.1-0.2-0.2-0.2-0.4l-5.4-22.1c-0.3-1.1-0.8-1.9-1.6-2.6s-1.7-1-2.8-1L0,116.8L0,116.8z"
                />
                <path
                  d="M64.3,126.1v-9.4H36.9v37.6h27.4v-9.4h-4.6c-1.3,0-2.3,0.5-3.2,1.4c-0.9,0.9-1.3,2-1.3,3.3
					c0,0.6-0.2,1.2-0.7,1.7c-0.4,0.4-1,0.7-1.6,0.7h-4.6c-0.6,0-1.2-0.2-1.6-0.7c-0.4-0.4-0.7-1-0.7-1.7v-10c0-0.6,0.2-1.2,0.7-1.6
					c0.4-0.5,1-0.7,1.6-0.7h11.4v-3.5H48.3c-0.6,0-1.2-0.2-1.6-0.7c-0.4-0.4-0.7-1-0.7-1.7v-10c0-0.6,0.2-1.2,0.7-1.7
					c0.4-0.4,1-0.7,1.6-0.7h4.6c0.6,0,1.2,0.2,1.6,0.7c0.4,0.5,0.7,1,0.7,1.7c0,1.3,0.4,2.4,1.3,3.3c0.9,0.9,2,1.4,3.2,1.4L64.3,126.1
					z"
                />
                <path
                  d="M78.3,154.3c-1.3,0-2.4-0.5-3.2-1.4c-0.9-0.9-1.3-2-1.3-3.3v-32.9h4.6c1.3,0,2.3,0.5,3.2,1.4
					c0.9,0.9,1.3,2,1.3,3.3v28.2c0,0.6,0.2,1.2,0.7,1.7c0.5,0.5,1,0.7,1.6,0.7h4.6c0.6,0,1.2-0.2,1.6-0.7c0.4-0.4,0.7-1,0.7-1.7v-28.2
					h9.2v28.2c0,0.6,0.2,1.2,0.7,1.7c0.4,0.5,1,0.7,1.6,0.7h4.6c0.6,0,1.2-0.2,1.6-0.7c0.5-0.5,0.7-1,0.7-1.7v-28.2
					c0-1.3,0.4-2.4,1.3-3.3c0.9-0.9,2-1.4,3.2-1.4h4.6v32.9c0,1.3-0.4,2.4-1.3,3.3c-0.9,0.9-2,1.4-3.2,1.4H78.3z"
                />
                <path
                  d="M142.2,116.8v37.6h4.6c1.3,0,2.3-0.5,3.2-1.4c0.9-0.9,1.3-2,1.3-3.3v-10.6c0-0.6,0.2-1.2,0.7-1.7
					c0.4-0.4,1-0.7,1.6-0.7h4.6c0.6,0,1.2,0.2,1.6,0.7c0.4,0.5,0.7,1,0.7,1.7v10.6c0,1.3,0.4,2.4,1.3,3.3c0.9,0.9,2,1.4,3.2,1.4h4.6
					v-37.6H165c-1.3,0-2.3,0.5-3.2,1.4c-0.9,0.9-1.3,2-1.3,3.3V132c0,0.6-0.2,1.2-0.7,1.6c-0.4,0.5-1,0.7-1.6,0.7h-4.6
					c-0.6,0-1.2-0.2-1.6-0.7c-0.4-0.4-0.7-1-0.7-1.6v-10.6c0-1.3-0.4-2.4-1.3-3.3c-0.9-0.9-2-1.4-3.2-1.4H142.2z"
                />
                <path
                  d="M183.6,116.8c-1.3,0-2.3,0.5-3.2,1.4c-0.9,0.9-1.3,2-1.3,3.3v28.2c0,1.3,0.4,2.4,1.3,3.3
					c0.9,0.9,2,1.4,3.2,1.4h18.3c1.3,0,2.4-0.5,3.2-1.4c0.9-0.9,1.3-2,1.3-3.3v-28.2c0-1.3-0.4-2.4-1.3-3.3c-0.9-0.9-2-1.4-3.2-1.4
					H183.6L183.6,116.8z M197.4,149.6c0,0.6-0.2,1.2-0.7,1.7c-0.5,0.5-1,0.7-1.6,0.7h-4.6c-0.6,0-1.2-0.2-1.6-0.7
					c-0.4-0.4-0.7-1-0.7-1.7v-28.2c0-0.6,0.2-1.2,0.7-1.7c0.4-0.4,1-0.7,1.6-0.7h4.6c0.6,0,1.2,0.2,1.6,0.7c0.5,0.5,0.7,1,0.7,1.7
					L197.4,149.6z"
                />
                <path
                  d="M234.2,132c0,0.6-0.2,1.2-0.7,1.6c-0.4,0.5-1,0.7-1.6,0.7h-4.6c-0.6,0-1.2-0.2-1.6-0.7
					c-0.4-0.4-0.7-1-0.7-1.6v-10.6c0-0.6,0.2-1.2,0.7-1.7c0.4-0.4,1-0.7,1.6-0.7h4.6c0.6,0,1.2,0.2,1.6,0.7c0.4,0.5,0.7,1,0.7,1.7
					L234.2,132z M238.8,116.8h-22.9v37.6h4.6c1.3,0,2.3-0.5,3.2-1.4c0.9-0.9,1.3-2,1.3-3.3v-10.6c0-0.6,0.2-1.2,0.7-1.7
					c0.4-0.4,1-0.7,1.6-0.7h4.6c0.6,0,1.2,0.2,1.6,0.7s0.7,1,0.7,1.7v10.6c0,1.3,0.4,2.4,1.3,3.3c0.9,0.9,2,1.4,3.2,1.4h4.6v-14.4
					l0-0.1v-0.1l0-0.1v-0.1h0v-0.1c0-0.1,0-0.1-0.1-0.2v0l0-0.1l0,0v-0.1l0,0l0-0.1v0l0-0.1l0,0l0-0.1v0l0-0.1l-0.1-0.1v0l-0.1-0.1
					v-0.1l-0.1-0.1v0l0-0.1h0l0-0.1v0l0-0.1l-0.1-0.1v0l0,0l0-0.1l0,0l0-0.1l-0.1-0.1v0l-0.1-0.1l-0.1-0.1l-0.1,0l0,0l0-0.1l-0.1-0.2
					l-0.1-0.1h0l0-0.1l-0.2-0.2l-0.1-0.1l-0.2-0.2h0l-0.1-0.1l-0.1,0l-0.1-0.1c-0.1,0-0.1-0.1-0.2-0.1l0,0c-0.1,0-0.1-0.1-0.2-0.1
					c-0.7-0.4-1.4-0.6-2.2-0.6c1.3,0,2.4-0.5,3.2-1.4c0.9-0.9,1.3-2,1.3-3.3v-9.4c0-1.3-0.4-2.4-1.3-3.3
					C241.1,117.2,240,116.7,238.8,116.8L238.8,116.8z"
                />
                <path
                  d="M251.2,116.8v3.5h4.6c0.6,0,1.1,0.2,1.6,0.6s0.7,0.9,0.7,1.5v26.2c-0.1,0.6-0.3,1.1-0.7,1.6
					c-0.4,0.4-0.9,0.6-1.6,0.6h-4.6v3.5h22.9v-3.5h-4.6c-0.6,0-1.2-0.2-1.6-0.7c-0.4-0.5-0.7-1-0.7-1.7c0-8.6,0-17.2,0-25.8
					c0-0.7,0.2-1.2,0.7-1.7c0.4-0.4,1-0.7,1.6-0.7h4.6v-3.5H251.2L251.2,116.8z"
                />
                <path
                  d="M309.4,116.8h-22.9c-1.3,0-2.3,0.5-3.2,1.4c-0.9,0.9-1.3,2-1.3,3.3v4.7h4.6c1.3,0,2.3-0.5,3.2-1.4
					c0.9-0.9,1.3-2,1.3-3.3c0-0.6,0.2-1.2,0.7-1.7c0.4-0.4,1-0.7,1.6-0.7h6.3c0.4,0,0.8,0.2,1,0.7c0.2,0.4,0.2,0.8-0.1,1.2l-17.7,24.2
					c-0.6,0.8-0.9,1.8-0.9,2.8v6.3h22.9c1.3,0,2.3-0.5,3.2-1.4c0.9-0.9,1.3-2,1.3-3.3v-4.7h-4.6c-1.3,0-2.4,0.5-3.2,1.4
					c-0.9,0.9-1.3,2-1.3,3.3c0,0.6-0.2,1.2-0.7,1.7c-0.5,0.5-1,0.7-1.6,0.7h-6.3c-0.5,0-0.8-0.2-1-0.7c-0.2-0.4-0.2-0.8,0.1-1.2
					l17.7-24.3c0.6-0.8,0.9-1.8,0.9-2.8L309.4,116.8z"
                />
                <path
                  d="M323.4,116.8c-1.3,0-2.3,0.5-3.2,1.4c-0.9,0.9-1.3,2-1.3,3.3v28.2c0,1.3,0.4,2.4,1.3,3.3
					c0.9,0.9,2,1.4,3.2,1.4h18.3c1.3,0,2.4-0.5,3.2-1.4c0.9-0.9,1.3-2,1.3-3.3v-28.2c0-1.3-0.4-2.4-1.3-3.3c-0.9-0.9-2-1.4-3.2-1.4
					H323.4z M337.1,149.6c0,0.6-0.2,1.2-0.7,1.7c-0.5,0.5-1,0.7-1.6,0.7h-4.6c-0.6,0-1.2-0.2-1.6-0.7c-0.4-0.4-0.7-1-0.7-1.7v-28.2
					c0-0.6,0.2-1.2,0.7-1.7c0.4-0.4,1-0.7,1.6-0.7h4.6c0.6,0,1.2,0.2,1.6,0.7c0.5,0.5,0.7,1,0.7,1.7V149.6z"
                />
                <path
                  d="M355.7,116.8v37.6h4.6c1.3,0,2.3-0.5,3.2-1.4c0.9-0.9,1.3-2,1.3-3.3v-20.9c0-0.1,0-0.3,0.1-0.4
					c0.1-0.1,0.2-0.2,0.4-0.2c0.1,0,0.3,0,0.4,0.1c0.1,0.1,0.2,0.2,0.2,0.4l5.4,22.1c0.7,2.2,2.1,3.4,4.4,3.6c2.4,0,4.8,0,7.2,0h0.2
					v-37.6h-4.6c-1.3,0-2.3,0.5-3.2,1.4c-0.9,0.9-1.3,2-1.3,3.3v20.9c0,0.1,0,0.3-0.1,0.4c-0.1,0.1-0.2,0.2-0.4,0.2
					c-0.1,0-0.3,0-0.4-0.1c-0.1-0.1-0.2-0.2-0.2-0.4l-5.4-22.1c-0.3-1.1-0.8-1.9-1.6-2.6s-1.7-1-2.8-1L355.7,116.8L355.7,116.8z"
                />
                <path
                  d="M404,134.4c-0.6,0-1.2-0.2-1.6-0.7c-0.4-0.4-0.7-1-0.7-1.6v-10.6c0-0.6,0.2-1.2,0.7-1.7s1-0.7,1.6-0.7h4.6
					c0.6,0,1.2,0.2,1.6,0.7c0.4,0.5,0.7,1,0.7,1.7c0,1.3,0.4,2.4,1.3,3.3c0.9,0.9,2,1.4,3.2,1.4h4.6v-4.7c0-1.3-0.5-2.4-1.3-3.3
					c-0.9-0.9-2-1.4-3.2-1.4h-18.3c-1.3,0-2.3,0.5-3.2,1.4c-0.9,0.9-1.3,2-1.3,3.3V132c0,1.3,0.4,2.4,1.3,3.3c0.9,0.9,2,1.4,3.2,1.4
					h11.4c0.6,0,1.2,0.2,1.6,0.7c0.4,0.5,0.7,1,0.7,1.7v10.6c0,0.6-0.2,1.2-0.7,1.7c-0.4,0.5-1,0.7-1.6,0.7H404
					c-0.6,0-1.2-0.2-1.6-0.7c-0.4-0.4-0.7-1-0.7-1.7c0-1.3-0.5-2.4-1.3-3.3c-0.9-0.9-2-1.4-3.2-1.4h-4.6v4.7c0,1.3,0.4,2.4,1.3,3.3
					c0.9,0.9,2,1.4,3.2,1.4h18.3c1.3,0,2.3-0.5,3.2-1.4c0.9-0.9,1.3-2,1.3-3.3v-10.6c0-1.3-0.5-2.4-1.3-3.3c-0.9-0.9-2-1.4-3.2-1.4
					L404,134.4z"
                />
              </g>
              <g>
                <path
                  d="M269.6,19v11.2l-14.1,5.7v54.9h-9.6l-0.1-40.4l-14,5.7v34.7h-10.2V1.5l4.4-1.5h1.2L269.6,19z M269.6,30.2
					l22.5,18.3v40l1,2.3h-23.4V30.2z M218.9,2.3v88.4h-5.7V4.1L218.9,2.3z M210.6,4.9v85.8h-5.7v-84L210.6,4.9z M202.4,7.6v83.1h-5.7
					V9.3L202.4,7.6z M194.1,10.1v80.6h-5.6V12L194.1,10.1z M185.8,12.8v78h-5.7V14.6L185.8,12.8z M172,17.3l5.7-1.8v75.3H172V17.3z
						M168.3,38.4l-23,7.1V42l23-7.1V38.4z M168.3,43.9l-23,7.1v-3.4l23-7.2V43.9z M168.3,49.4l-23,7.1V53l23-7.1V49.4z M168.3,54.9
					l-41.3,12.7v-3.4l41.3-12.7V54.9z M168.3,60.4l-41.3,12.7v-3.5L168.3,57V60.4z M126.9,78.6l41.3-12.8v-3.4l-41.3,12.7V78.6z
						M168.3,71.4l-41.3,12.9v-3.6L168.3,68V71.4z M168.3,90.7h-41.3v-4.4l41.3-12.9V90.7z"
                />
              </g>
            </g>
          </svg>
        </Link>
        <form
          onSubmit={handleSubmit}
          className="flex-1 flex bg-slate-100 p-3 px-6 rounded-3xl items-center border border-solid border-transparent shadow-3xl min-w-0"
        >
          <input
            type="text"
            placeholder="Search..."
            className="bg-transparent focus:outline-none w-full"
            value={searchTerm}
            onChange={(e) => setSearchTerm(e.target.value)}
          />
          <button type="submit" className="flex-shrink-0 ml-2">
            <FaSearch className="text-slate-600" />
          </button>
        </form>
        <nav className="flex-shrink-0">
          <ul className="flex items-center gap-4 font-medium text-lg">
            <Link to="/">
              <li className="hidden sm:inline text-slate-700 hover:underline whitespace-nowrap">
                Home
              </li>
            </Link>
            <Link to="/about">
              <li className="hidden sm:inline text-slate-700 hover:underline whitespace-nowrap">
                About
              </li>
            </Link>
            <Link to="/profile">
              {currentUser ? (
                <img
                  className="rounded-full h-9 w-9 object-cover flex-shrink-0"
                  src={currentUser.avatar}
                  alt="avatar"
                />
              ) : (
                <li className="text-slate-700 hover:underline whitespace-nowrap">
                  Sign in
                </li>
              )}
            </Link>
          </ul>
        </nav>
      </div>
    </header>
  );
}
